<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:pm="http://primefaces.org/mobile"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <f:view renderKitId="PRIMEFACES_MOBILE" />
    <h:head>
        <style>
            .badge {
                background: black;
                color: white;
                border-radius: 20px;
                padding: 0.25em 0.75em ;
                margin-left: 0.5em;
            }
            
            #feed .ui-title {
                margin: 0;
            }
            
            #feed li, #feedItem li {
                margin: 0;
                padding: 0;
            }
            
            #feed li button, #feedItem li button {
                margin: 0;
            }
            
            #feedItem .ui-content {
                padding: 0;
            }
            #feedItem .ui-content .ui-btn {
                margin: 0;
            }
            #feedItem .ui-content ul {
                margin: 0;
            }
            
            #feedItem button {
                white-space: normal;
                text-align: left;
            }
            
            #feedItem .readed-false {
                background-color: rgba(171, 207, 255, 1);
            }
        </style>
    </h:head>
    <h:body>
        <!-- Lecture des flux -->
        <pm:page id="feed">
            <pm:header title="Visualisation des flux rss/atom"></pm:header>
            <pm:content>
                <h:form>
                    <p:dataList value="#{feedItemLazyMobileManaged.feeds}" var="feed">
                        <p:commandButton icon="ui-icon-carat-r" iconPos="right" escape="false" value="#{feed.name} #{htmlManaged.badge(feedItemLazyMobileManaged.feedsUnReadCounter[feed])}" action="#{feedItemLazyMobileManaged.setFeed(feed)}" update=":feedItem"/>
                    </p:dataList>
                </h:form>
            </pm:content>
        </pm:page>
        
        <!-- Lecture des articles -->
        <pm:page id="feedItem" lazy="true">
            <pm:header fixed="true">
                <f:facet name="left">
                    <p:commandButton action="pm:feed" value="Retour" style="width: auto;" icon="ui-icon-back" update=":feed"/>
                </f:facet>
                <f:facet name="right">
                    <h1 class="ui-title" role="heading" aria-level="1"><h:outputText escape="false" value="#{feedItemLazyMobileManaged.feed.name} #{htmlManaged.badge(feedItemLazyMobileManaged.feedsUnReadCounter[feedItemLazyMobileManaged.feed])}"/></h1>
                </f:facet>
            </pm:header>
            <pm:content>
                <h:form id="feedItemForm">
                    <h:panelGroup id="feedItemList" rendered="#{feedItemLazyMobileManaged.feed != null}">
                        <div style="text-align: center; margin: 0.5em;">
                            <p:commandButton icon="ui-icon-arrow-l" value="Précédent" action="#{feedItemLazyMobileManaged.previousPage()}" update="feedItemForm:feedItemList" style="float: left; width: auto;"/>
                            <p:commandButton icon="ui-icon-arrow-r"  iconPos="right" value="Suivant" action="#{feedItemLazyMobileManaged.nextPage()}" update="feedItemForm:feedItemList" style="float: right; width: auto;"/>
                            <div style="padding: 0.7em 1em;">#{feedItemLazyMobileManaged.page} / #{feedItemLazyMobileManaged.totalPage}</div>
                        </div>
                        <div style="clear: both"/>
                        <p:dataList value="#{feedItemLazyMobileManaged.feedItems}" paginator="true" rows="20" var="feedItem">
                            <p:commandButton styleClass="readed-#{feedItem.readed}" icon="ui-icon-carat-r" iconPos="right" value="#{feedItem.title}" action="#{feedItemLazyMobileManaged.setFeedItem(feedItem)}" update=":feedItemAction"/>
                        </p:dataList>
                    </h:panelGroup>
                </h:form>
            </pm:content>
        </pm:page>
        
        <!-- Affichage d'un article -->
        <pm:page id="feedItemAction" lazy="true">
            <pm:header fixed="true">
                <f:facet name="left">
                    <p:commandButton action="pm:feedItem" value="Retour" style="width: auto;" icon="ui-icon-back" update=":feedItem"/>
                </f:facet>
                <f:facet name="right">
                    <h1 class="ui-title" role="heading" aria-level="1"><h:outputText escape="false" value="#{feedItemLazyMobileManaged.feed.name} #{htmlManaged.badge(feedItemLazyMobileManaged.feedsUnReadCounter[feedItemLazyMobileManaged.feed])}"/></h1>
                </f:facet>
            </pm:header>
            <pm:content>
                <h:panelGroup rendered="#{feedItemLazyMobileManaged.feedItem != null}">
                    <p:panel header="#{feedItemLazyMobileManaged.feedItem.title}">
                        <h:outputText escape="false" value="#{feedItemLazyMobileManaged.feedItem.summary}"/>
                        <br/>
                        <p:link href="#{feedItemLazyMobileManaged.feedItem.link}" value="Lien vers l'article"/>
                    </p:panel>
                </h:panelGroup>
            </pm:content>
        </pm:page>
        
    </h:body>
</html>

